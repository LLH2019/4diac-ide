<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension
         point="org.eclipse.ui.views">
      <view
            allowMultiple="false"
            category="org.eclipse.fordiac.ide.view.category"
            class="org.eclipse.fordiac.ide.typemanagement.navigator.TypeNavigator"
            icon="fordiacimage://ICON_TYPE_NAVIGATOR"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.view"
            name="Type Navigator">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.editors">
      <editor
            class="org.eclipse.ui.editors.text.TextEditor"
            contributorClass="org.eclipse.ui.editors.text.TextEditorActionContributor"
            extensions="dev"
            icon="fordiacimage://ICON_DEVICE"
            id="org.eclipse.fordiac.ide.fbtypeeditor.editors.DeviceTypeEditor"
            name="Device Type Editor">
      </editor>
      <editor
            class="org.eclipse.ui.editors.text.TextEditor"
            contributorClass="org.eclipse.ui.editors.text.TextEditorActionContributor"
            extensions="res"
            icon="fordiacimage://ICON_RESOURCE"
            id="org.eclipse.fordiac.ide.fbtypeeditor.editors.ResourceTypeEditor"
            name="Resource Type Editor">
      </editor>
      <editor
            class="org.eclipse.ui.editors.text.TextEditor"
            contributorClass="org.eclipse.ui.editors.text.TextEditorActionContributor"
            extensions="seg"
            icon="fordiacimage://ICON_SEGMENT"
            id="org.eclipse.fordiac.ide.fbtypeeditor.editors.SegmentTypeEditor"
            name="Segment Type Editor">
      </editor>
   </extension>
   <extension
         point="org.eclipse.ui.newWizards">
      <wizard
            category="org.eclipse.fordiac.ide.newWizard.category"
            class="org.eclipse.fordiac.ide.typemanagement.wizards.NewTypeWizard"
            icon="fordiacimage://ICON_NEW_FUNCTIONBLOCK"
            id="org.eclipse.fordiac.ide.typemanagement.wizards.NewFBTypeWizard"
            name="Type...">
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.navigator.viewer">
      <viewer
            viewerId="org.eclipse.fordiac.ide.typemanagement.navigator.view">
      </viewer>
      <viewerContentBinding
            viewerId="org.eclipse.fordiac.ide.typemanagement.navigator.view">
         <includes>
            <contentExtension
                  pattern="org.eclipse.ui.navigator.resourceContent"/>
                  <contentExtension pattern="org.eclipse.ui.navigator.resources.filters.startsWithDot"/>
                  <contentExtension pattern="org.eclipse.ui.navigator.resources.filters.closedProject"/>
                  <contentExtension pattern="org.eclipse.fordiac.ide.typemanagement.navigator.filters.showonly61499Types"/>
                  <contentExtension pattern="org.eclipse.fordiac.ide.typemanagement.navigator.filters.*"/>
                  <contentExtension pattern="org.eclipse.ui.navigator.resources.filters.workingSet"/>
                  <contentExtension
                        isRoot="true"
                        pattern="org.eclipse.fordiac.ide.typemanagement.toolLibraryContent">
                  </contentExtension>
                  <contentExtension
                        pattern="org.eclipse.fordiac.ide.typemanagement.fbTypeContent">
                  </contentExtension>
                  <contentExtension
                  pattern="org.eclipse.ui.navigator.resources.linkHelper" />
                  
         </includes>
      </viewerContentBinding>
      <viewerActionBinding 
            viewerId="org.eclipse.fordiac.ide.typemanagement.navigator.view">
          <includes>
       	     <actionExtension pattern="org.eclipse.ui.navigator.resources.*" />		       	      
          </includes>
       </viewerActionBinding>
      <dragAssistant
            class="org.eclipse.fordiac.ide.typemanagement.FBTypeDragAssistant"
            viewerId="org.eclipse.fordiac.ide.typemanagement.navigator.view">
      </dragAssistant>
   </extension>
   <extension point="org.eclipse.ui.commands">
    	<command
        	id="org.eclipse.fordiac.ide.typemanagement.openType"
        	name="Open Type">
    	</command>
	</extension>
   <extension
         point="org.eclipse.ui.bindings">
      <key
            commandId="org.eclipse.fordiac.ide.typemanagement.openType"
            contextId="org.eclipse.ui.contexts.window"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="CTRL+SHIFT+T">
      </key>
   </extension>
   <extension point="org.eclipse.ui.handlers">
    	<handler
        	class="org.eclipse.fordiac.ide.typemanagement.handlers.OpenTypeHandler"
        	commandId="org.eclipse.fordiac.ide.typemanagement.openType">
    	</handler>
	</extension>
   <extension
         point="org.eclipse.ui.navigator.navigatorContent">
      <commonFilter
            activeByDefault="true"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.filters.showonly61499Types"
            name="Show only IEC 61499 Types"
            visibleInUI="true">
         <filterExpression>
                  <or>
                     <not>
                        <or>
                           <instanceof value="org.eclipse.emf.edit.provider.ItemProviderAdapter"/>
                           <instanceof value="org.eclipse.emf.ecore.EObject"/>
                           <instanceof value="org.eclipse.fordiac.ide.typemanagement.navigator.TypeLibRootElement"/>
                           <instanceof
                                 value="org.eclipse.core.resources.IFolder">
                           </instanceof>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="dtp">
                              </test>
                           </and>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="fbt">
                              </test>
                           </and>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="adp">
                              </test>
                           </and>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="seg">
                              </test>
                           </and>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="res">
                              </test>
                           </and>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="dev">
                              </test>
                           </and>
                           <and>
                              <instanceof
                                    value="org.eclipse.core.resources.IFile">
                              </instanceof>
                              <test
                                    property="org.eclipse.core.resources.extension"
                                    value="sub">
                              </test>
                           </and>
                           <instanceof
                                 value="org.eclipse.core.resources.IProject">
                           </instanceof>
                        </or>
                     </not>
                     <adapt
                           type="org.eclipse.core.resources.IProject">
                        <test
                              property="org.eclipse.core.resources.name"
                              value="Tool Library">
                        </test>
                     </adapt>
                  </or>
        </filterExpression>
      </commonFilter>
      <commonFilter
            activeByDefault="false"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.filters.hideAdapters"
            name="Adapters"
            visibleInUI="true">
         <filterExpression>                  
           <and>
              <instanceof
                    value="org.eclipse.core.resources.IFile">
              </instanceof>
              <test
                    property="org.eclipse.core.resources.extension"
                    value="adp">
              </test>
           </and>                           
        </filterExpression>
      </commonFilter>
      <commonFilter
            activeByDefault="false"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.filters.hideDevices"
            name="Devices"
            visibleInUI="true">
         <filterExpression>                  
           <and>
              <instanceof
                    value="org.eclipse.core.resources.IFile">
              </instanceof>
              <test
                    property="org.eclipse.core.resources.extension"
                    value="dev">
              </test>
           </and>                           
        </filterExpression>
      </commonFilter>
      <commonFilter
            activeByDefault="false"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.filters.hideResources"
            name="Resources"
            visibleInUI="true">
         <filterExpression>                  
           <and>
              <instanceof
                    value="org.eclipse.core.resources.IFile">
              </instanceof>
              <test
                    property="org.eclipse.core.resources.extension"
                    value="res">
              </test>
           </and>                           
        </filterExpression>
      </commonFilter>
      <commonFilter
            activeByDefault="false"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.filters.hideFBs"
            name="Function Blocks"
            visibleInUI="true">
         <filterExpression>                  
           <and>
              <instanceof
                    value="org.eclipse.core.resources.IFile">
              </instanceof>
              <test
                    property="org.eclipse.core.resources.extension"
                    value="fbt">
              </test>
           </and>                           
        </filterExpression>
      </commonFilter>
      <commonFilter
            activeByDefault="false"
            id="org.eclipse.fordiac.ide.typemanagement.navigator.filters.hideSegments"
            name="Segments"
            visibleInUI="true">
         <filterExpression>                  
           <and>
              <instanceof
                    value="org.eclipse.core.resources.IFile">
              </instanceof>
              <test
                    property="org.eclipse.core.resources.extension"
                    value="seg">
              </test>
           </and>                           
        </filterExpression>
      </commonFilter>
   </extension>
   <extension
         point="org.eclipse.ui.navigator.navigatorContent">
      <navigatorContent
            activeByDefault="true"
            contentProvider="org.eclipse.fordiac.ide.typemanagement.navigator.FBTypeContentProvider"
            id="org.eclipse.fordiac.ide.typemanagement.fbTypeContent"
            labelProvider="org.eclipse.fordiac.ide.typemanagement.navigator.FBTypeLabelProvider"
            name="FB Type Content">
            <possibleChildren>
	           <or>         
	              <instanceof value="org.eclipse.core.resources.IFile" /> 
	              <instanceof value="org.eclipse.emf.ecore.EObject"/>
	              <instanceof value="org.eclipse.emf.edit.provider.ItemProviderAdapter"/>
	           </or>
	        </possibleChildren> 
            <triggerPoints>
            <or>
               <instanceof 
	                     value="org.eclipse.emf.ecore.EObject"/>
             <and>
               <instanceof 
                     value="org.eclipse.core.resources.IResource">
               </instanceof>               
               <or>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="fbt">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="adp">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="res">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="dev">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="seg">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="sub">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="prg">
               </test>
               </or>
             </and>
            </or>
            </triggerPoints>
            <commonSorter
                  class="org.eclipse.fordiac.ide.typemanagement.navigator.KeepOrderContentSorter"
                  id="org.eclipse.fordiac.ide.typemanagement.navigator.FBContentSorter">
               <parentExpression>
                  <or>
                     <instanceof
                           value="org.eclipse.fordiac.ide.model.libraryElement.FBType">
                     </instanceof>
                     <instanceof
                           value="org.eclipse.core.resources.IFile">
                     </instanceof>
                     <instanceof
                           value="org.eclipse.fordiac.ide.model.libraryElement.InterfaceList">
                     </instanceof>
                  </or>
               </parentExpression>
            </commonSorter>
      </navigatorContent>
      <navigatorContent
            activeByDefault="true"
            contentProvider="org.eclipse.fordiac.ide.typemanagement.navigator.ToolLibraryContentProvider"
            id="org.eclipse.fordiac.ide.typemanagement.toolLibraryContent"
            labelProvider="org.eclipse.fordiac.ide.typemanagement.navigator.ToolLibraryLabelProvider"
            name="Toollibrary">
            <possibleChildren>
           <or>         
              <instanceof 
                    value="org.eclipse.core.resources.IWorkspaceRoot" /> 
              <instanceof
                    value="org.eclipse.core.resources.IProject" /> 
              <instanceof 
                     value="org.eclipse.core.resources.IResource" /> 
              <instanceof  
                     value="org.eclipse.core.resources.IFolder" />
              <instanceof 
                     value="org.eclipse.core.resources.IFile" /> 
         </or>
     </possibleChildren>
            <triggerPoints>
            <and>
               <instanceof
                     value="org.eclipse.core.resources.IProject">
               </instanceof>
               <test
                     property="org.eclipse.core.resources.name"
                     value="Tool Library">
               </test>
            </and></triggerPoints>
      </navigatorContent>
      <commonWizard
            type="new"
            wizardId="org.eclipse.fordiac.ide.typemanagement.wizards.NewFBTypeWizard">
         <enablement></enablement>
      </commonWizard>
      <commonWizard
            type="new"
            wizardId="org.eclipse.fordiac.ide.systemmanagement.ui.wizard.New4diacProjectWizard">
         <enablement></enablement>
      </commonWizard>      
   </extension>
   <extension
         point="org.eclipse.ltk.core.refactoring.renameParticipants">
      <renameParticipant
            class="org.eclipse.fordiac.ide.typemanagement.RenameType"
            id="org.eclipse.fordiac.ide.typemanagement.renameType"
            name="Rename Type handler">
         <enablement>
         	<and>
               <instanceof 
                     value="org.eclipse.core.resources.IFile">
               </instanceof>               
               <or>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="fbt">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="adp">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="res">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="dev">
               </test>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="seg">
               </test>
               </or>
             </and>
         </enablement>
      </renameParticipant>
   </extension>
   <extension
         point="org.eclipse.ui.views.properties.tabbed.propertySections">
      <propertySections
            contributorId="property.contributor.fb">
         <propertySection
               class="org.eclipse.fordiac.ide.typemanagement.properties.FBTypeInfoSection"
               id="property.section.typenavigator.fBTypeInfo"
               tab="property.tab.fbtypeinfo">
            <input
                  type="org.eclipse.core.resources.IFile">
            </input>
         </propertySection>
      </propertySections>
   </extension>
   <extension
         point="org.eclipse.ltk.core.refactoring.deleteParticipants">
      <deleteParticipant
            class="org.eclipse.fordiac.ide.typemanagement.DeleteFBTypeParticipant"
            id="org.eclipse.fordiac.ide.typemanagement.deleteFBType"
            name="Delete FB Type Handler">
         <enablement>
         	<and>
         		<instanceof 
                     value="org.eclipse.core.resources.IFile">
               </instanceof>
               <test
               		 forcePluginActivation="true"	
                     property="org.eclipse.core.resources.extension"
                     value="fbt">
               </test>
            </and>   
         </enablement>
               
      </deleteParticipant>
   </extension>
    <extension
         point="org.eclipse.ui.navigator.viewer">
      <viewer
            viewerId="org.eclipse.fordiac.ide.systemmanagement.ui.systemexplorer">
      </viewer>
      <dragAssistant
            class="org.eclipse.fordiac.ide.typemanagement.FBTypeDragAssistant"
            viewerId="org.eclipse.fordiac.ide.systemmanagement.ui.systemexplorer">
      </dragAssistant>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      <page
            category="org.eclipse.fordiac.ide.preferences.FordiacPreferencePage"
            class="org.eclipse.fordiac.ide.typemanagement.preferences.TypeManagementPreferencePage"
            id="org.eclipse.fordiac.ide.typemanagement.preferences.TypeManagementPreferencePage"
            name="Type Management Preferences">
      </page>
   </extension>
   <extension
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="org.eclipse.fordiac.ide.typemanagement.preferences.PreferenceInitializer">
      </initializer>
   </extension>
   <extension
         point="org.eclipse.ui.decorators">
      <decorator
            class="org.eclipse.fordiac.ide.typemanagement.navigator.TypeDecorator"
            icon="fordiacimage://ICON_FB_TYPE"
            id="org.eclipse.fordiac.ide.typemanagement.TypeDecorator"
            label="4diac Type Decoration"
            lightweight="true"
            state="true">
            <enablement>
                <objectClass name="org.eclipse.core.resources.IFile" />
            </enablement>
            <description>
               Show type comment beside the type name.
            </description>
      </decorator>
   </extension>
</plugin>
